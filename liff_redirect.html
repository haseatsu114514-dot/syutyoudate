<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>予約完了処理中...</title>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: sans-serif;
            background-color: #f0f0f0;
            color: #333;
        }

        .container {
            text-align: center;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #06c755;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="spinner"></div>
        <p>LINEへ送信中...</p>
        <p id="status" style="font-size: 12px; color: #666;"></p>
    </div>

    <script>
        // ★★★ここにLIFF IDを入れてください★★★
        const LIFF_ID = 'YOUR_LIFF_ID_HERE';

        async function main() {
            const statusEl = document.getElementById('status');

            try {
                // 1. LIFF初期化
                await liff.init({ liffId: LIFF_ID });

                // 2. ログインチェック（未ログインならログイン画面へ）
                if (!liff.isLoggedIn()) {
                    liff.login();
                    return;
                }

                // 3. メッセージ送信
                statusEl.textContent = 'メッセージを作成中...';

                await liff.sendMessages([
                    { type: 'text', text: '予約フォームを送信しました' }
                ]);

                statusEl.textContent = '完了しました。画面を閉じます。';

                // 4. ウィンドウを閉じる
                setTimeout(() => {
                    liff.closeWindow();
                }, 1000);

            } catch (err) {
                console.error(err);
                // エラー時はデバッグしやすいように表示
                statusEl.textContent = 'エラーが発生しました: ' + err.code + ' ' + err.message;
                statusEl.style.color = 'red';

                // LIFFブラウザ以外で開いた場合の案内
                if (err.code === 'FNRBsrIsNtu' || err.message.includes('liff.sendMessages()')) {
                    statusEl.innerHTML += '<br><br>このページはLINEアプリ内で開いてください。';
                }
            }
        }

        // 実行
        main();
    </script>
</body>

</html>